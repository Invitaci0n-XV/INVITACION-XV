<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Invitaci√≥n XV Interactiva</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      background: #111;
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    .container {
      position: relative;
      width: 100vw;
      max-width: 400px;
      aspect-ratio: 9/16;
    }
    video {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
      background: #000;
      border-radius: 16px;
      pointer-events: none;
      outline: none;
      -webkit-appearance: none;
      appearance: none;
    }
    video::-webkit-media-controls {
      display: none !important;
    }
    .arrow-btn {
      position: absolute;
      bottom: 8vw;
      width: 44px;
      height: 44px;
      background: rgba(255,255,255,0.8);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.18);
      border: none;
      cursor: pointer;
      z-index: 10;
      transition: opacity 0.3s;
      opacity: 0;
      pointer-events: none;
    }
    .arrow-btn.visible {
      opacity: 1;
      pointer-events: auto;
    }
    .arrow-btn svg {
      width: 28px;
      height: 28px;
      fill: #222;
    }
    #arrow-right { right: 10vw; }
    #arrow-left  { left: 10vw; }
  </style>
</head>
<body>
  <div class="container">
    <video id="videoXV" preload="auto" playsinline muted tabindex="-1">
      <source src="invitacion-xv.mp4" type="video/mp4">
    </video>
    <button id="arrow-right" class="arrow-btn" aria-label="Avanzar">
      <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
    </button>
    <button id="arrow-left" class="arrow-btn" aria-label="Retroceder">
      <svg viewBox="0 0 24 24"><path d="M16 19V5l-11 7z"/></svg>
    </button>
  </div>
  <script>
    // Tiempos de pausa ajustados
    const PAUSAS_DERECHA = [11, 12, 14]; // Saltamos la pausa en 13
    const PAUSAS_IZQUIERDA = [16, 18, 20];

    const video = document.getElementById('videoXV');
    const rightArrow = document.getElementById('arrow-right');
    const leftArrow = document.getElementById('arrow-left');

    let etapa = 0; // 0: inicio, 1: click para avanzar, 2: derecha, 3: izquierda
    let derechaIndex = 0;
    let izquierdaIndex = 0;
    let esperandoClick = false;
    let clicksDerechaCompletos = false;

    // ---- Al cargar, espera 1s y pausa en 1s ----
    video.addEventListener('loadedmetadata', () => {
      video.currentTime = 0;
      setTimeout(() => {
        video.play();
        // Pausa en el segundo 1
        video.addEventListener('timeupdate', function pausaEn1() {
          if (video.currentTime >= 1 && etapa === 0) {
            video.pause();
            etapa = 1;
            esperandoClick = true;
            video.removeEventListener('timeupdate', pausaEn1);
          }
        });
      }, 1000); // Espera 1 segundo antes de reproducir
    });

    // ---- Espera click para avanzar hasta 8s ----
    document.body.addEventListener('click', function handleFirstClick(e) {
      if (etapa === 1 && esperandoClick) {
        esperandoClick = false;
        etapa = 2;
        video.play();
        derechaIndex = 0;
        // Pausa en el segundo 8
        video.addEventListener('timeupdate', function pausaEn8() {
          if (video.currentTime >= 8 && etapa === 2 && derechaIndex === 0) {
            video.pause();
            rightArrow.classList.add('visible');
            video.removeEventListener('timeupdate', pausaEn8);
          }
        });
        document.body.removeEventListener('click', handleFirstClick);
      }
    });

    // ---- Secuencia clicks DERECHA ----
    rightArrow.addEventListener('click', () => {
      if (etapa === 2 && derechaIndex < PAUSAS_DERECHA.length) {
        derechaIndex++;
        rightArrow.classList.remove('visible');
        video.play();
        // Pausa en el siguiente tiempo (11, 12, 14)
        video.addEventListener('timeupdate', function pausaSecuenciaDerecha() {
          if (video.currentTime >= PAUSAS_DERECHA[derechaIndex - 1]) {
            video.pause();
            if (derechaIndex < PAUSAS_DERECHA.length) {
              rightArrow.classList.add('visible');
            } else {
              leftArrow.classList.add('visible');
              etapa = 3;
              izquierdaIndex = 0;
              clicksDerechaCompletos = true;
            }
            video.removeEventListener('timeupdate', pausaSecuenciaDerecha);
          }
        });
      }
    });

    // ---- Secuencia clicks IZQUIERDA ----
    leftArrow.addEventListener('click', () => {
      if (etapa === 3 && izquierdaIndex < PAUSAS_IZQUIERDA.length) {
        izquierdaIndex++;
        leftArrow.classList.remove('visible');
        video.play();
        video.addEventListener('timeupdate', function pausaSecuenciaIzquierda() {
          if (video.currentTime >= PAUSAS_IZQUIERDA[izquierdaIndex - 1]) {
            video.pause();
            if (izquierdaIndex < PAUSAS_IZQUIERDA.length) {
              leftArrow.classList.add('visible');
            } else {
              // Reinicia desde el segundo 8 y vuelve al estado inicial de flechas
              setTimeout(() => {
                video.currentTime = 8;
                etapa = 2;
                derechaIndex = 0;
                izquierdaIndex = 0;
                clicksDerechaCompletos = false;
                rightArrow.classList.add('visible');
                leftArrow.classList.remove('visible');
                video.pause();
              }, 600);
            }
            video.removeEventListener('timeupdate', pausaSecuenciaIzquierda);
          }
        });
      }
    });

    // Oculta controles nativos del video
    video.controls = false;
    video.setAttribute('controls', false);
    video.muted = true;
    video.setAttribute('muted', 'muted');
    video.setAttribute('playsinline', '');

    setTimeout(() => {
      video.removeAttribute('controls');
    }, 100);
  </script>
</body>
</html>